
if command -v zoxide &> /dev/null; then
    eval "$(zoxide init zsh --cmd cd)"
fi

set -o vi                                                # VI editing mode

export PATH="$PATH:$HOME/dotfiles/scripts"

alias lg='lazygit'
alias vim='nvim'
alias dvim='dtach -A /tmp/nvim.socket -r winch nvim'
alias dnvim='dtach -A /tmp/nvim.socket -r winch nvim'
alias ls='ls --color=auto'
alias taskui='taskwarrior-tui'
alias nvcd='nvr -c "cd ${PWD}"'
alias ,='nvr -c "cd ${PWD}"'

HISTSIZE=5000                                            # Number of history lines kept in memory
SAVEHIST=5000                                            # Number of history lines saved to disk
HISTFILE=~/.zsh_history                                  # File where history is saved
setopt appendhistory                                     # Append new history lines to the history file instead of overwriting
setopt sharehistory                                      # Share history across multiple terminals
setopt incappendhistory                                  # Append history immediately, not just on shell exit
setopt interactive_comments                              # Allow comments in the interactive shell

autoload -U up-line-or-beginning-search
autoload -U down-line-or-beginning-search
zle -N up-line-or-beginning-search
zle -N down-line-or-beginning-search
bindkey "^[[A" up-line-or-beginning-search
bindkey "^[OA" up-line-or-beginning-search
bindkey "^[[B" down-line-or-beginning-search
bindkey "^[OB" down-line-or-beginning-search

setopt PROMPT_SUBST
format_current_git_branch() {
  local branch=$(git rev-parse --abbrev-ref HEAD 2>/dev/null)
  if [[ -n $branch ]]; then
    echo "%F{magenta}($branch)%f "
  fi
}
format_exit_status() {
  if [[ $? -ne 0 && $? -ne 130 ]]; then
    echo "%(?..%F{red}(%?%) )"
  elif [[ $? -eq 0 ]]; then
    echo ""
  fi
}
PROMPT='%B$(format_exit_status)%F{green}%n%f %F{blue}%1~%f $(format_current_git_branch)%# %b'

